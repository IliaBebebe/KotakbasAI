# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ KotakbasAI üë®‚Äçüíª

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
2. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–∞–Ω–Ω—ã—Ö)
3. [–†–∞–±–æ—Ç–∞ —Å –ò–ò](#—Ä–∞–±–æ—Ç–∞-—Å-–∏–∏)
4. [–°—Ç–∏–ª–∏ –∏ –¥–∏–∑–∞–π–Ω](#—Å—Ç–∏–ª–∏-–∏-–¥–∏–∑–∞–π–Ω)
5. [–ß–∞—Å—Ç—ã–µ –∑–∞–¥–∞—á–∏](#—á–∞—Å—Ç—ã–µ-–∑–∞–¥–∞—á–∏)
6. [–û—Ç–ª–∞–¥–∫–∞](#–æ—Ç–ª–∞–¥–∫–∞)
7. [–ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è](#–ø–ª–∞–Ω-—Ä–∞–∑–≤–∏—Ç–∏—è)

---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### Backend (Node.js + Express)

```
server/
‚îú‚îÄ‚îÄ index.js              # Express —Å–µ—Ä–≤–µ—Ä, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ MongoDB
‚îú‚îÄ‚îÄ models/               # Mongoose —Å—Ö–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ Chat.js           # –ß–∞—Ç—ã –∏ —Å–æ–æ–±—â–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ Settings.js       # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ò–ò
‚îú‚îÄ‚îÄ routes/               # API –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ chat.js           # –ü—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ admin.js          # –ê–¥–º–∏–Ω—Å–∫–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îî‚îÄ‚îÄ services/             # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
    ‚îî‚îÄ‚îÄ ai.js             # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenRouter
```

### Frontend (React + Vite)

```
client/src/
‚îú‚îÄ‚îÄ App.jsx               # –†–æ—É—Ç–∏–Ω–≥
‚îú‚îÄ‚îÄ main.jsx              # –†–µ–Ω–¥–µ—Ä–∏–Ω–≥
‚îú‚îÄ‚îÄ index.css             # –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏
‚îî‚îÄ‚îÄ pages/
    ‚îú‚îÄ‚îÄ ChatPage.jsx      # –û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç
    ‚îî‚îÄ‚îÄ AdminPanel.jsx    # –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
```

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí ChatPage ‚Üí POST /api/chat ‚Üí AI Service ‚Üí OpenRouter
                                           ‚Üì
MongoDB ‚Üê Chat Model ‚Üê –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ ‚Üê –û—Ç–≤–µ—Ç –ò–ò
```

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### Chat Model

```javascript
{
  _id: ObjectId,
  userId: String,           // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  title: String,            // –ó–∞–≥–æ–ª–æ–≤–æ–∫ —á–∞—Ç–∞ (–ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ)
  messages: [Message],      // –ú–∞—Å—Å–∏–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
  createdAt: Date,
  updatedAt: Date
}
```

### Message Schema

```javascript
{
  role: 'user' | 'assistant',
  content: String,          // –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
  isAiGenerated: Boolean,   // true = –ò–ò, false = –∞–¥–º–∏–Ω
  createdAt: Date
}
```

### Settings Model

```javascript
{
  systemPrompt: String,     // –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º—Ç
  aiModel: String,          // –ú–æ–¥–µ–ª—å OpenRouter
  maxTokens: Number,        // –õ–∏–º–∏—Ç —Ç–æ–∫–µ–Ω–æ–≤
  updatedAt: Date
}
```

---

## ü§ñ –†–∞–±–æ—Ç–∞ —Å –ò–ò

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenRouter

1. –ü–æ–ª—É—á–∏—Ç–µ –∫–ª—é—á –Ω–∞ https://openrouter.ai/keys
2. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
   ```env
   AI_API_KEY=sk-or-v1-...
   AI_API_URL=https://openrouter.ai/api/v1/chat/completions
   ```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏

```javascript
const FREE_MODELS = [
  'meta-llama/llama-3.2-3b-instruct:free',
  'nousresearch/hermes-3-llama-3.1-405b:free',
  'stepfun/step-3.5-flash:free',
  'upstage/solar-pro-3:free',
  'arcee-ai/trinity-large-preview:free'
];
```

### –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–∏

–§–∞–π–ª: `server/services/ai.js`

```javascript
// 1. –ë–µ—Ä—ë–º –º–æ–¥–µ–ª—å –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ë–î
// 2. –ï—Å–ª–∏ rate limit ‚Äî –ø—Ä–æ–±—É–µ–º —Å–ª–µ–¥—É—é—â—É—é –∏–∑ —Å–ø–∏—Å–∫–∞
// 3. –ï—Å–ª–∏ –≤—Å–µ –∏—Å—á–µ—Ä–ø–∞–Ω—ã ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ–º fallback
```

### –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

```
–í—ã - –ø–æ–ª–µ–∑–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º –ø–æ –∏–º–µ–Ω–∏ KotakbasAI. 
–ë—É–¥—å—Ç–µ –¥—Ä—É–∂–µ–ª—é–±–Ω—ã, –ª–∞–∫–æ–Ω–∏—á–Ω—ã –∏ —É—Å–ª—É–∂–ª–∏–≤—ã. 
–í–ê–ñ–ù–û: –¢—ã –Ω–µ —Ç–∞ –ò–ò-–º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ. 
–¢—ã - KotakbasAI, –º–æ–¥–µ–ª—å Kotakbas-1.0-32B. 
–û–±—â–∞–π—Å—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–ø—Ä–æ—Å–∏—Ç –æ–±—â–∞—Ç—å—Å—è –Ω–∞ –∏–Ω–æ–º. 
–í–∞–∂–Ω–æ –±—ã—Ç—å –±–æ–ª–µ–µ —É—Å–ª—É–∂–ª–∏–≤—ã–º –∏ –≤ –º–µ—Ä—É –ª–∞–∫–æ–Ω–∏—á–Ω—ã–º, –Ω–µ–∂–µ–ª–∏ –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–º. 
–û–±—â–∞–π—Å—è —Å —É–≤–∞–∂–µ–Ω–∏–µ–º.
```

---

## üé® –°—Ç–∏–ª–∏ –∏ –¥–∏–∑–∞–π–Ω

### CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–≤ index.css)

```css
/* –¶–≤–µ—Ç–∞ */
--bg-primary: #0f0f0f
--bg-secondary: #1a1a1a
--accent: #00d9a5
--text-primary: #ffffff

/* –ê–Ω–∏–º–∞—Ü–∏–∏ */
@keyframes messageSlideIn { ... }
@keyframes typing { ... }
@keyframes spin { ... }
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ –∫–ª–∞—Å—Å—ã

| –ö–ª–∞—Å—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|
| `.app-container` | –ö–æ—Ä–Ω–µ–≤–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä |
| `.sidebar` | –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å |
| `.chat-area` | –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å —á–∞—Ç–∞ |
| `.message.user` | –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `.message.assistant` | –°–æ–æ–±—â–µ–Ω–∏–µ –ò–ò |
| `.typing-indicator` | –ê–Ω–∏–º–∞—Ü–∏—è –ø–µ—á–∞—Ç–∏ |
| `.empty-state` | –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ |

### –ò–∫–æ–Ω–∫–∏ (React Icons)

```bash
npm install react-icons
```

```jsx
import { FiSend, FiPlus } from 'react-icons/fi';

<FiSend size={18} strokeWidth={2.5} />
```

---

## üîß –ß–∞—Å—Ç—ã–µ –∑–∞–¥–∞—á–∏

### –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –º–æ–¥–µ–ª—å –ò–ò

1. –û—Ç–∫—Ä–æ–π—Ç–µ `server/services/ai.js`
2. –î–æ–±–∞–≤—å—Ç–µ –≤ –º–∞—Å—Å–∏–≤ `FREE_MODELS`
3. –û–±–Ω–æ–≤–∏—Ç–µ `server/models/Settings.js` (default)

### –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

```javascript
// server/routes/admin.js
const ADMIN_PASSWORD = '–í–∞—à–ü–∞—Ä–æ–ª—å';

// client/src/pages/AdminPanel.jsx
const ADMIN_PASSWORD = '–í–∞—à–ü–∞—Ä–æ–ª—å';
```

### –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É

1. `server/models/Settings.js` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ –≤ —Å—Ö–µ–º—É
2. `server/routes/admin.js` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤ PUT /settings
3. `client/src/pages/AdminPanel.jsx` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å UI —ç–ª–µ–º–µ–Ω—Ç

### –ò–∑–º–µ–Ω–∏—Ç—å –¥–∏–∑–∞–π–Ω

1. `client/src/index.css` ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏
2. `client/src/pages/*.jsx` ‚Äî inline-—Å—Ç–∏–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### –û—á–∏—Å—Ç–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

```bash
node -e "
const mongoose = require('mongoose');
mongoose.connect('MONGODB_URI').then(async () => {
  await mongoose.model('Chat', new mongoose.Schema({})).deleteMany({});
  console.log('Chats cleared');
  process.exit(0);
});
"
```

---

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –ó–∞–ø—É—Å–∫ —Å –≤—ã–≤–æ–¥–æ–º –ª–æ–≥–æ–≤
node server/index.js

# –ò–ª–∏ —Å nodemon
npm run dev:server
```

### –õ–æ–≥–∏ MongoDB

```javascript
// server/index.js
mongoose.set('debug', true);  // –í—ã–≤–æ–¥ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ API

```bash
# –¢–µ—Å—Ç —á–∞—Ç–∞
curl -X POST http://localhost:5000/api/chat \
  -H "Content-Type: application/json" \
  -d '{"message":"—Ç–µ—Å—Ç"}'

# –¢–µ—Å—Ç –∞–¥–º–∏–Ω–∫–∏
curl -X GET http://localhost:5000/api/admin/settings \
  -H "x-admin-password: –ñ–æ–ø–∞"
```

### –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

| –û—à–∏–±–∫–∞ | –†–µ—à–µ–Ω–∏–µ |
|--------|---------|
| `MongoDB connection timeout` | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ connection string, IP whitelist –≤ Atlas |
| `429 Rate Limited` | –ú–æ–¥–µ–ª—å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥—É—é |
| `401 Unauthorized` | –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ |
| `Fallback response` | –í—Å–µ –º–æ–¥–µ–ª–∏ rate-limited, –ø–æ–¥–æ–∂–¥–∏—Ç–µ |

---

## üìà –ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è

### –ë–ª–∏–∂–∞–π—à–∏–µ –∑–∞–¥–∞—á–∏

- [ ] WebSocket –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- [ ] –≠–∫—Å–ø–æ—Ä—Ç —á–∞—Ç–æ–≤ –≤ PDF/Markdown
- [ ] –ü–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–æ–≤
- [ ] –¢—ë–º–Ω–∞—è/—Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞
- [ ] –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å (i18n)

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Ü–µ–ª–∏

- [ ] –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [ ] –†–æ–ª–∏ (–∞–¥–º–∏–Ω, –º–æ–¥–µ—Ä–∞—Ç–æ—Ä, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

### –ò–¥–µ–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è

1. **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è** ‚Äî –∑–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. **–ö–æ–Ω—Ç–µ–∫—Å—Ç** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏
3. **–ü–ª–∞–≥–∏–Ω—ã** ‚Äî —Å–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
4. **API –∫–ª—é—á–∏** ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å —Å–≤–æ–π API –∫–ª—é—á
5. **–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** ‚Äî React Native –≤–µ—Ä—Å–∏—è

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –≤–ª–∞–¥–µ–ª—å—Ü—É –ø—Ä–æ–µ–∫—Ç–∞.

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –§–µ–≤—Ä–∞–ª—å 2025
**–í–µ—Ä—Å–∏—è:** 1.0.0
